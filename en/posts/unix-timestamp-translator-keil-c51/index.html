<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Unix Timestamp Translator For Keil C51 &#183; Aphcity's Mind City</title><meta name=title content="Unix Timestamp Translator For Keil C51 &#183; Aphcity's Mind City"><meta name=description content="My awesome website"><meta name=keywords content="C,C++,"><link rel=canonical href=https://aphcity.top/en/posts/unix-timestamp-translator-keil-c51/><meta name=author content="Aphcity"><link href=https://discord.gg/6XefQutTvq rel=me><link href=https://github.com/Aphcity rel=me><link href=https://steamcommunity.com/id/Aphcity/ rel=me><link href=https://twitter.com/_Aphcity rel=me><meta property="og:url" content="https://aphcity.top/en/posts/unix-timestamp-translator-keil-c51/"><meta property="og:site_name" content="Aphcity's Mind City"><meta property="og:title" content="Unix Timestamp Translator For Keil C51"><meta property="og:description" content="To implement with the timing function for the IoT module on the 8051 series microcontroller, we need to use Unix Time to record and transmit time in a standardized way. However, due to the particularity of the 8-bit microcontroller, we need to program the timestamp translator program with saving space and meeting the requirements of the C51 code. That also means that we cannot use the times.h from C99 and do more accurate calculations on choosing the data types to prevent data overflow."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-19T13:40:00+00:00"><meta property="article:modified_time" content="2024-06-20T15:05:40+00:00"><meta property="article:tag" content="C"><meta property="article:tag" content="C++"><meta name=twitter:card content="summary"><meta name=twitter:title content="Unix Timestamp Translator For Keil C51"><meta name=twitter:description content="To implement with the timing function for the IoT module on the 8051 series microcontroller, we need to use Unix Time to record and transmit time in a standardized way. However, due to the particularity of the 8-bit microcontroller, we need to program the timestamp translator program with saving space and meeting the requirements of the C51 code. That also means that we cannot use the times.h from C99 and do more accurate calculations on choosing the data types to prevent data overflow."><link type=text/css rel=stylesheet href=/css/main.bundle.min.e9d3896a53ce890057a0ef505a04ba5d113ab34679bfa4f8d1441476f67ae26676773cd154b97b293f7f1380f6a2b2aaa1ea753083cc2861fc17e0d58fdd30bb.css integrity="sha512-6dOJalPOiQBXoO9QWgS6XRE6s0Z5v6T40UQUdvZ64mZ2dzzRVLl7KT9/E4D2orKqoep1MIPMKGH8F+DVj90wuw=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP+pSqMXxm6JPOUeAg==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href="/apple-touch-icon.png?v=1.3"><link rel=icon type=image/png sizes=32x32 href="/favicon-32x32.png?v=1.3"><link rel=icon type=image/png sizes=16x16 href="/favicon-16x16.png?v=1.3"><link rel=manifest href="/site.webmanifest?v=1.3"><link rel=mask-icon href="/safari-pinned-tab.svg?v=1.3" color=#96ccdd><link rel="shortcut icon" href="/favicon.ico?v=1.3"><meta name=msapplication-TileColor content="#96ccdd"><meta name=theme-color content="#96ccdd"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Unix Timestamp Translator For Keil C51","headline":"Unix Timestamp Translator For Keil C51","abstract":"\u003cblockquote\u003e\n\u003cp\u003eTo implement with the timing function for the IoT module on the 8051 series microcontroller, we need to use \u003ca\n  href=\u0022https:\/\/en.wikipedia.org\/wiki\/Unix_time\u0022\n    target=\u0022_blank\u0022\n  \u003eUnix Time\u003c\/a\u003e to record and transmit time in a standardized way. However, due to the particularity of the 8-bit microcontroller, we need to program the timestamp translator program with saving space and meeting the requirements of the C51 code. That also means that we cannot use the \u003ccode\u003etimes.h\u003c\/code\u003e from C99 and do more accurate calculations on choosing the data types to prevent data overflow.\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/aphcity.top\/en\/posts\/unix-timestamp-translator-keil-c51\/","author":{"@type":"Person","name":"Aphcity"},"copyrightYear":"2024","dateCreated":"2024-06-19T13:40:00\u002b00:00","datePublished":"2024-06-19T13:40:00\u002b00:00","dateModified":"2024-06-20T15:05:40\u002b00:00","keywords":["C","C++"],"mainEntityOfPage":"true","wordCount":"1106"}]</script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js></script><script>const firebaseConfig={apiKey:"AIzaSyBV9VoGS3gGB0VF9AA3NK4EQ-diuPK_7Fw",authDomain:"aphcity-top.firebaseapp.com",projectId:"aphcity-top",storageBucket:"aphcity-top.appspot.com",messagingSenderId:"567753381512",appId:"1:567753381512:web:2198b32bd5153b52a7713d",measurementId:"G-65T89EKE99"};var app=firebase.initializeApp(firebaseConfig),db=firebase.firestore(),auth=firebase.auth()</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/en/ class="text-base font-medium">Aphcity&rsquo;s Mind City</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/en/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Posts><p class="text-base font-medium">Blog</p></a><a href=/en/categories/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Categories title=Categories><p class="text-base font-medium">Categories</p></a><div><div class="cursor-pointer flex items-center nested-menu"><a aria-label=Media class="text-base font-medium hover:text-primary-600 dark:hover:text-primary-400" title><p>Media</p></a><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/en/music/ aria-label=Music class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>Music</p></a><a href=/en/toolbox/woodenfish/ aria-label=Woodenfish class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>Woodenfish</p></a></div></div></div></div><a href=/en/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-base font-medium">Tags</p></a><div><div class="cursor-pointer flex items-center nested-menu"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Unix Timestamp Translator For Keil C51">EN-US</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/en/posts/unix-timestamp-translator-keil-c51/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Unix Timestamp Translator For Keil C51">🇺🇸 English</p></a><a href=/zh-cn/posts/unix-%E6%97%B6%E9%97%B4%E6%88%B3%E5%9C%A8-keil-c51-%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Unix 时间戳在 Keil C51 中的实现">🇨🇳 简体中文</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span><div><div class="cursor-pointer flex items-center nested-menu"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H256h48 16H576c35.3.0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H320 304 256 64c-35.3.0-64-28.7-64-64V128zm320 0V384H576V128H320zM178.3 175.9c-3.2-7.2-10.4-11.9-18.3-11.9s-15.1 4.7-18.3 11.9l-64 144c-4.5 10.1.1 21.9 10.2 26.4s21.9-.1 26.4-10.2l8.9-20.1h73.6l8.9 20.1c4.5 10.1 16.3 14.6 26.4 10.2s14.6-16.3 10.2-26.4l-64-144zM160 233.2 179 276H141l19-42.8zM448 164c11 0 20 9 20 20v4h44 16c11 0 20 9 20 20s-9 20-20 20h-2l-1.6 4.5c-8.9 24.4-22.4 46.6-39.6 65.4.9.6 1.8 1.1 2.7 1.6l18.9 11.3c9.5 5.7 12.5 18 6.9 27.4s-18 12.5-27.4 6.9L467 333.8c-4.5-2.7-8.8-5.5-13.1-8.5-10.6 7.5-21.9 14-34 19.4l-3.6 1.6c-10.1 4.5-21.9-.1-26.4-10.2s.1-21.9 10.2-26.4l3.6-1.6c6.4-2.9 12.6-6.1 18.5-9.8L410 286.1c-7.8-7.8-7.8-20.5.0-28.3s20.5-7.8 28.3.0l14.6 14.6.5.5c12.4-13.1 22.5-28.3 29.8-45H448 376c-11 0-20-9-20-20s9-20 20-20h52v-4c0-11 9-20 20-20z"/></svg></span></span><div class="text-sm font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Unix Timestamp Translator For Keil C51">EN-US</div></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/en/posts/unix-timestamp-translator-keil-c51/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Unix Timestamp Translator For Keil C51">🇺🇸 English</p></a><a href=/zh-cn/posts/unix-%E6%97%B6%E9%97%B4%E6%88%B3%E5%9C%A8-keil-c51-%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/ class="flex items-center"><p class="text-sm font-sm text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="Unix 时间戳在 Keil C51 中的实现">🇨🇳 简体中文</p></a></div></div></div></div><button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/en/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Posts><p class="text-bg font-bg">Blog</p></a></li><li class=mt-1><a href=/en/categories/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Categories title=Categories><p class="text-bg font-bg">Categories</p></a></li><li class=mt-1><a href aria-label=Media class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Media</p><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/en/music/ aria-label=Music class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>Music</p></a></li><li class=mt-1><a href=/en/toolbox/woodenfish/ aria-label=Woodenfish class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>Woodenfish</p></a></li><li class=mb-2></li><li class=mt-1><a href=/en/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-bg font-bg">Tags</p></a></li></ul><hr><ul class="flex mt-4 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li class=mb-1><a href=/en/resume/ class="flex items-center"><span class=mr-3><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M320 32c-8.1.0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9.0 149.9.0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9V320c0 28.4-10.8 57.7-22.3 80.8-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3.9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7.3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7-3.2-14.2-7.5-28.7-13.5-42V291.9c0-30.2 10.2-58.7 27.9-81.5 12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5.8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1l280.6-101c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"/></svg></span></span><p class="text-sm font-sm" title=resume>Resume</p></a></li></ul></div></div></div></div><div class="main-menu flex pb-3 flex-col items-end justify-between md:justify-start space-x-3"><div class="hidden md:flex items-center space-x-5"><a href=/en/resume/ class="flex items-center"><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M320 32c-8.1.0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9.0 149.9.0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9V320c0 28.4-10.8 57.7-22.3 80.8-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3.9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7.3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7-3.2-14.2-7.5-28.7-13.5-42V291.9c0-30.2 10.2-58.7 27.9-81.5 12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5.8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1l280.6-101c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"/></svg></span></span><p class="text-xs font-light" title=resume>Resume</p></a></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="overflow-hidden rounded-md h-36 md:h-56 lg:h-72 nozoom"><img src=/img/default-cover.2q5oxoasyv00_hu_3d981d3327ae8429.webp alt="Unix Timestamp Translator For Keil C51" loading=eager decoding=async fetchpriority=high class="w-full h-full nozoom object-cover"></div><div class="single_hero_background nozoom fixed inset-x-0 top-0 h-[800px]"><img id=background-image-main src=/img/default-cover.2q5oxoasyv00_hu_3d981d3327ae8429.webp alt role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 h-full w-full object-cover"><div class="from-neutral absolute inset-0 bg-gradient-to-t to-transparent mix-blend-normal dark:from-neutral-800"></div><div class="from-neutral to-neutral absolute inset-0 bg-gradient-to-t opacity-30 mix-blend-normal dark:from-neutral-800 dark:to-neutral-800 dark:opacity-60"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script type=text/javascript src=/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=background-blur data-image-id=background-image-main data-image-url=/img/default-cover.2q5oxoasyv00.webp></script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Unix Timestamp Translator For Keil C51</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-06-19T13:40:00+00:00>June 19 2024</time><span class="px-2 text-primary-500">&#183;</span><time datetime=2024-06-20T15:05:40+00:00>Updated: June 20 2024</time><span class="px-2 text-primary-500">&#183;</span><span>1106 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">3 mins</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/2024-06-20-unix-时间戳在-keil-c51-中的实现.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span>
</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=likes_posts/2024-06-20-unix-时间戳在-keil-c51-中的实现.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=likes>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span>
</span><span class="px-2 text-primary-500">&#183;</span><span>
<button id=button_likes class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
<span id=button_likes_heart class="inline-block align-text-bottom hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M47.6 300.4 228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6.0 115.2.0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span>
</span><span id=button_likes_emtpty_heart class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M244 84l11.1 12 12-11.98C300.6 51.37 347 36.51 392.6 44.1 461.5 55.58 512 115.2 512 185.1V190.9c0 41.5-17.2 81.2-47.6 109.5L283.7 469.1c-7.5 7-17.4 10.9-27.7 10.9S235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1.0 232.4.0 190.9V185.1c0-69.9 50.52-129.52 119.4-141 44.7-7.59 92 7.27 124.6 39.9C243.1 84 244 84.01 244 84zm11.1 79.9-45-46.8c-21.7-20.82-52.5-30.7-82.8-25.66C81.55 99.07 48 138.7 48 185.1V190.9c0 28.2 11.71 55.2 32.34 74.4L256 429.3l175.7-164c20.6-19.2 32.3-46.2 32.3-74.4V185.1c0-46.4-33.6-86.03-79.3-93.66C354.4 86.4 323.6 96.28 301.9 117.1l-46.8 46.8z"/></svg></span></span>
<span id=button_likes_text>&nbsp;Like</span>
</button>
</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/Aphcity/aphcity.github.io/posts/2024-06-20-unix-%e6%97%b6%e9%97%b4%e6%88%b3%e5%9c%a8-keil-c51-%e4%b8%ad%e7%9a%84%e5%ae%9e%e7%8e%b0.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Edit content"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span></span></a></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/en/categories/study/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Study
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/en/categories/internship/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Internship
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/en/tags/c/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">C
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/en/tags/c++/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">C++</span></span></a></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4" width=96 height=96 alt=Aphcity src=/img/avatar.5esiw34k8aw0_hu_c8e5d9a095900940.webp data-zoom-src=/img/avatar.5esiw34k8aw0.webp><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Aphcity</div><div class="text-sm text-neutral-700 dark:text-neutral-400">I&rsquo;m just an average student, and I do forget things</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:chalk.talisman@gmail.com target=_blank aria-label=Email title=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://discord.gg/6XefQutTvq target=_blank aria-label=Discord title=Discord rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 640 512"><path fill="currentColor" d="M524.531 69.836a1.5 1.5.0 00-.764-.7A485.065 485.065.0 00404.081 32.03a1.816 1.816.0 00-1.923.91 337.461 337.461.0 00-14.9 30.6 447.848 447.848.0 00-134.426.0 309.541 309.541.0 00-15.135-30.6 1.89 1.89.0 00-1.924-.91A483.689 483.689.0 00116.085 69.137a1.712 1.712.0 00-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016.0 00.765 1.375A487.666 487.666.0 00176.02 479.918a1.9 1.9.0 002.063-.676A348.2 348.2.0 00208.12 430.4a1.86 1.86.0 00-1.019-2.588 321.173 321.173.0 01-45.868-21.853 1.885 1.885.0 01-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819.0 011.9-.256c96.229 43.917 200.41 43.917 295.5.0a1.812 1.812.0 011.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884.0 01-.162 3.126 301.407 301.407.0 01-45.89 21.83 1.875 1.875.0 00-1 2.611 391.055 391.055.0 0030.014 48.815 1.864 1.864.0 002.063.7A486.048 486.048.0 00610.7 405.729a1.882 1.882.0 00.765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972.0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665.0 53.306 26.82 52.843 59.239.0 32.654-23.41 59.241-52.843 59.241zm195.38.0c-28.971.0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667.0 53.307 26.82 52.844 59.239.0 32.654-23.177 59.241-52.844 59.241z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/Aphcity target=_blank aria-label=Github title=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://steamcommunity.com/id/Aphcity/ target=_blank aria-label=Steam title=Steam rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111.2 248-248.4 248-113.8.0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2.0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5.0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79.0 0027.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3S206 305.6 193 300.2c-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4.0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9.0 46.9-21 46.9-46.8.0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/_Aphcity target=_blank aria-label=X-Twitter title=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#resources>Resources</a></li><li><a href=#algorithms-under-windows-os>Algorithms under Windows OS</a><ul><li><a href=#unix-timestamp-to-rtc-time>Unix Timestamp to RTC time</a><ul><li><a href=#logic-and-debugging>Logic and debugging</a></li></ul></li><li><a href=#rtc-time-to-unix-timestamp>RTC time to Unix Timestamp</a><ul><li><a href=#logic>Logic</a></li></ul></li></ul></li><li><a href=#keil-debugging>Keil Debugging</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#resources>Resources</a></li><li><a href=#algorithms-under-windows-os>Algorithms under Windows OS</a><ul><li><a href=#unix-timestamp-to-rtc-time>Unix Timestamp to RTC time</a><ul><li><a href=#logic-and-debugging>Logic and debugging</a></li></ul></li><li><a href=#rtc-time-to-unix-timestamp>RTC time to Unix Timestamp</a><ul><li><a href=#logic>Logic</a></li></ul></li></ul></li><li><a href=#keil-debugging>Keil Debugging</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><blockquote><p>To implement with the timing function for the IoT module on the 8051 series microcontroller, we need to use <a href=https://en.wikipedia.org/wiki/Unix_time target=_blank>Unix Time</a> to record and transmit time in a standardized way. However, due to the particularity of the 8-bit microcontroller, we need to program the timestamp translator program with saving space and meeting the requirements of the C51 code. That also means that we cannot use the <code>times.h</code> from C99 and do more accurate calculations on choosing the data types to prevent data overflow.</p></blockquote><h2 class="relative group">Resources<div id=resources class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#resources aria-label=Anchor>#</a></span></h2><p>Repo: <a href=https://github.com/Aphcity/timestamp target=_blank>https://github.com/Aphcity/timestamp</a></p><p>Unix Time Online Translator: <a href=https://tool.lu/timestamp/ target=_blank>https://tool.lu/timestamp/</a></p><h2 class="relative group">Algorithms under Windows OS<div id=algorithms-under-windows-os class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#algorithms-under-windows-os aria-label=Anchor>#</a></span></h2><p>Code works under Windows: <a href=https://github.com/Aphcity/timestamp/blob/6022208cb928c63070128f1f11a6a2ea06960534/ target=_blank>Branch 6022208</a></p><p>Use <code>TS_time_</code> to represent real time.</p><h3 class="relative group">Unix Timestamp to RTC time<div id=unix-timestamp-to-rtc-time class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#unix-timestamp-to-rtc-time aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=n>time_struct</span> <span class=nf>stamptotime</span><span class=p>(</span><span class=kt>uint32_t</span> <span class=n>stamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>uint8_t</span> <span class=n>month_buf</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>31</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>time_struct</span> <span class=n>t_out</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>min_add</span><span class=p>,</span> <span class=n>hour_add</span><span class=p>,</span> <span class=n>day_add</span><span class=p>,</span> <span class=n>mon_add</span><span class=p>,</span> <span class=n>year_add</span><span class=p>,</span> <span class=n>day_temp</span><span class=p>,</span> <span class=n>year_temp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>h_year</span> <span class=o>=</span> <span class=mi>19</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>l_year</span> <span class=o>=</span> <span class=mi>70</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>mon</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>day</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>hour</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>min</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>sec</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>min_add</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>sec</span> <span class=o>+</span> <span class=n>stamp</span><span class=p>)</span> <span class=o>/</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>sec</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>sec</span> <span class=o>+</span> <span class=n>stamp</span><span class=p>)</span> <span class=o>%</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>hour_add</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>min</span> <span class=o>+</span> <span class=n>min_add</span><span class=p>)</span> <span class=o>/</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>min</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>min</span> <span class=o>+</span> <span class=n>min_add</span><span class=p>)</span> <span class=o>%</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>day_add</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>hour</span> <span class=o>+</span> <span class=n>hour_add</span><span class=p>)</span> <span class=o>/</span> <span class=mi>24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>hour</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>hour</span> <span class=o>+</span> <span class=n>hour_add</span><span class=p>)</span> <span class=o>%</span> <span class=mi>24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mon_add</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>day_temp</span> <span class=o>=</span> <span class=n>t_out</span><span class=p>.</span><span class=n>day</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>t_out</span><span class=p>.</span><span class=n>mon</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>size_t</span> <span class=n>a</span> <span class=o>=</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>year_temp</span> <span class=o>=</span> <span class=n>t_out</span><span class=p>.</span><span class=n>h_year</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=n>t_out</span><span class=p>.</span><span class=n>l_year</span> <span class=o>+</span> <span class=p>(</span><span class=n>i</span> <span class=o>/</span> <span class=mi>12</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>size_t</span> <span class=n>temp</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=nf>leapyear_check</span><span class=p>(</span><span class=n>year_temp</span><span class=p>))</span> <span class=o>?</span> <span class=p>(</span><span class=n>month_buf</span><span class=p>[</span><span class=n>a</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>:</span> <span class=n>month_buf</span><span class=p>[</span><span class=n>a</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* If we update the month, initial the day to the &#39;1&#39; */</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>mon_add</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>day_temp</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>day_add</span> <span class=o>+</span> <span class=n>day_temp</span> <span class=o>&gt;</span> <span class=n>temp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>mon_add</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>day_add</span> <span class=o>-=</span> <span class=p>(</span><span class=n>temp</span> <span class=o>-</span> <span class=n>day_temp</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>t_out</span><span class=p>.</span><span class=n>day</span> <span class=o>+=</span> <span class=n>day_add</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>year_add</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>mon</span> <span class=o>+</span> <span class=n>mon_add</span><span class=p>)</span> <span class=o>/</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>mon</span> <span class=o>=</span> <span class=p>(</span><span class=n>t_out</span><span class=p>.</span><span class=n>mon</span> <span class=o>+</span> <span class=n>mon_add</span><span class=p>)</span> <span class=o>%</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Reset the base to Jan.01.2000 when year_add is greater than 30
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>year_add</span> <span class=o>&gt;</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>year_add</span> <span class=o>-=</span> <span class=mi>30</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>t_out</span><span class=p>.</span><span class=n>h_year</span> <span class=o>=</span> <span class=mi>20</span> <span class=o>+</span> <span class=n>year_add</span> <span class=o>/</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>year_add</span> <span class=o>=</span> <span class=n>year_add</span> <span class=o>%</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>t_out</span><span class=p>.</span><span class=n>l_year</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=n>t_out</span><span class=p>.</span><span class=n>h_year</span> <span class=o>=</span> <span class=mi>19</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>t_out</span><span class=p>.</span><span class=n>l_year</span> <span class=o>+=</span> <span class=n>year_add</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>t_out</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><code>month_buf</code> is to store the number of days per month in a normal year, and <code>leapyear_check</code> is to ensure that the extra day in a leap year can be correctly calculated.</p><h4 class="relative group">Logic and debugging<div id=logic-and-debugging class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#logic-and-debugging aria-label=Anchor>#</a></span></h4><p>Calculate the seconds, minutes, and hours that do not require complex calculations, and simply take the remainder first.</p><p>As for the date part, first calculate the number of days added, and then start to traverse <code>month_buf</code> to get the year and month that have passed, and get the year increment and month increment.</p><ol><li>When processing increments greater than 30 years, it was found that the original code (as shown below) would cause overflow in the output of the low-byte year.</li></ol><ul><li>This is because the year increment is rounded up every 100 years in the calculation while the starting year is 1970. The low-byte year 70 will increase to 100+ when processing data of 30+.</li><li>There are two solutions here. After the addition, check the low-byte year again, and if it is greater than 100, choose to carry it to the high-byte; judge the year increment in advance. When the increment is greater than or equal to 30 years, directly add one to the high-byte, and reduce the increment by 30, which is equivalent to resetting the initial benchmark of the timestamp to 2000. This is a easier way to understand, so the second one is chosen.</li></ul><ol><li>When processing the actual time month in December, since 12n % 12 == 0, 12 will be directly carried to year_add, causing the year to be incremented by one, and the month to be 0. Therefore, a conditional judgment is added to ensure that December is not carried.</li></ol><h3 class="relative group">RTC time to Unix Timestamp<div id=rtc-time-to-unix-timestamp class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#rtc-time-to-unix-timestamp aria-label=Anchor>#</a></span></h3><p>This function is relatively simpler than converting to RTC, and the logic is in a similar way</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=kt>uint32_t</span> <span class=nf>timetostamp</span><span class=p>(</span><span class=n>time_struct</span> <span class=n>t_in</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>uint8_t</span> <span class=n>month_buf</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>31</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>31</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>stamp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>year</span> <span class=o>=</span> <span class=n>t_in</span><span class=p>.</span><span class=n>h_year</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=n>t_in</span><span class=p>.</span><span class=n>l_year</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 计算已过年的秒数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>uint32_t</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>1970</span><span class=p>;</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=n>year</span><span class=p>;</span> <span class=n>y</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>stamp</span> <span class=o>+=</span> <span class=nf>leapyear_check</span><span class=p>(</span><span class=n>y</span><span class=p>)</span> <span class=o>?</span> <span class=mi>366</span> <span class=o>*</span> <span class=mi>86400</span> <span class=o>:</span> <span class=mi>365</span> <span class=o>*</span> <span class=mi>86400</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 计算已过月的秒数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>uint8_t</span> <span class=n>m</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>m</span> <span class=o>&lt;</span> <span class=n>t_in</span><span class=p>.</span><span class=n>mon</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>m</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>m</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=nf>leapyear_check</span><span class=p>(</span><span class=n>year</span><span class=p>))</span> <span class=c1>// February in a leap year
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>stamp</span> <span class=o>+=</span> <span class=mi>29</span> <span class=o>*</span> <span class=mi>86400</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=n>stamp</span> <span class=o>+=</span> <span class=n>month_buf</span><span class=p>[</span><span class=n>m</span><span class=p>]</span> <span class=o>*</span> <span class=mi>86400</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 计算已过天的秒数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>stamp</span> <span class=o>+=</span> <span class=p>(</span><span class=n>t_in</span><span class=p>.</span><span class=n>day</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>86400</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 计算已过时分秒的秒数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>stamp</span> <span class=o>+=</span> <span class=n>t_in</span><span class=p>.</span><span class=n>hour</span> <span class=o>*</span> <span class=mi>3600</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>stamp</span> <span class=o>+=</span> <span class=n>t_in</span><span class=p>.</span><span class=n>min</span> <span class=o>*</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>stamp</span> <span class=o>+=</span> <span class=n>t_in</span><span class=p>.</span><span class=n>sec</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 返回 int
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=n>stamp</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 class="relative group">Logic<div id=logic class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#logic aria-label=Anchor>#</a></span></h4><p>First, calculate the increment in seconds corresponding to the year increment. This can be calculated directly, but note that leap years will add an extra year. Then calculate the full month starting from January and the total number of days it contains. Then integrate and add the increment in seconds corresponding to the number of days, hours, minutes, and seconds themselves to get the result.</p><p>The logic is simple. Compared with the previous function, it is less prone to omissions in calculation or thinking. No errors were found during the debugging process.</p><h2 class="relative group">Keil Debugging<div id=keil-debugging class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#keil-debugging aria-label=Anchor>#</a></span></h2><p>In C51, the type sizes of <code>short</code> and <code>int</code> are the same, both are 16 bytes. This also caused data overflow when transferring the code to Keil. <code>unsigned long</code> was used as the storage method for 32-bit unsigned integers. Here is a reference to the basic common data types in C51.</p><table><thead><tr><th style=text-align:center>Data Types</th><th style=text-align:center>Bits</th><th style=text-align:center>Bytes</th><th style=text-align:center>Minium Value</th><th style=text-align:center>Maxium Value</th></tr></thead><tbody><tr><td style=text-align:center>bit</td><td style=text-align:center>1</td><td style=text-align:center></td><td style=text-align:center>0</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>signed char</td><td style=text-align:center>8</td><td style=text-align:center>1</td><td style=text-align:center>-128</td><td style=text-align:center>127</td></tr><tr><td style=text-align:center>unsigned char</td><td style=text-align:center>8</td><td style=text-align:center>1</td><td style=text-align:center>0</td><td style=text-align:center>255</td></tr><tr><td style=text-align:center>enum</td><td style=text-align:center>8 / 16</td><td style=text-align:center>1 / 2</td><td style=text-align:center>-128 / -32768</td><td style=text-align:center>+127 / +32767</td></tr><tr><td style=text-align:center>signed short int</td><td style=text-align:center>16</td><td style=text-align:center>2</td><td style=text-align:center>-32768</td><td style=text-align:center>+32767</td></tr><tr><td style=text-align:center>unsigned short int</td><td style=text-align:center>16</td><td style=text-align:center>2</td><td style=text-align:center>0</td><td style=text-align:center>65535</td></tr><tr><td style=text-align:center>signed int</td><td style=text-align:center>16</td><td style=text-align:center>2</td><td style=text-align:center>-32768</td><td style=text-align:center>+32767</td></tr><tr><td style=text-align:center>unsigned int</td><td style=text-align:center>16</td><td style=text-align:center>2</td><td style=text-align:center>0</td><td style=text-align:center>65535</td></tr><tr><td style=text-align:center>signed long int</td><td style=text-align:center>32</td><td style=text-align:center>4</td><td style=text-align:center>-2147483648</td><td style=text-align:center>+2147483647</td></tr><tr><td style=text-align:center>unsigned long int</td><td style=text-align:center>32</td><td style=text-align:center>4</td><td style=text-align:center>0</td><td style=text-align:center>4294967295</td></tr><tr><td style=text-align:center>float</td><td style=text-align:center>32</td><td style=text-align:center>4</td><td style=text-align:center>±1.175494E-38</td><td style=text-align:center>±3.402823E+38</td></tr><tr><td style=text-align:center>double</td><td style=text-align:center>32</td><td style=text-align:center>4</td><td style=text-align:center>±1.175494E-38</td><td style=text-align:center>±3.402823E+38</td></tr><tr><td style=text-align:center>sbit</td><td style=text-align:center>1</td><td style=text-align:center></td><td style=text-align:center>0</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>sfr</td><td style=text-align:center>8</td><td style=text-align:center>1</td><td style=text-align:center>0</td><td style=text-align:center>255</td></tr><tr><td style=text-align:center>sfr16</td><td style=text-align:center>16</td><td style=text-align:center>2</td><td style=text-align:center>0</td><td style=text-align:center>65535</td></tr></tbody></table></div></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/2024-06-20-unix-时间戳在-keil-c51-中的实现.md data-oid-likes=likes_posts/2024-06-20-unix-时间戳在-keil-c51-中的实现.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/en/posts/new-post/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Hello World
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2022-02-07T15:28:25+00:00>February 7 2022</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/en/posts/github-i-always-need-to-cheat-on-this/><span class=leading-6>GitHub: I always need to cheat on this&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-02-07T03:26:54+00:00>February 7 2025</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-24 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/en/tags/ title=Tags>Tags</a></li><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/en/categories/ title=Categories>Categories</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">Copy, <em>right?</em> :thinking_face:</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://aphcity.top/en/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>